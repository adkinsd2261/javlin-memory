
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jav Studio - Your Creative AI Partner</title>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .magic-gradient {
            background: linear-gradient(45deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 400% 400%;
            animation: gradient-dance 8s ease infinite;
        }

        @keyframes gradient-dance {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
        }

        .jav-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
            animation: pulse-glow 3s ease-in-out infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .jav-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
        }

        @keyframes pulse-glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 40px rgba(102, 126, 234, 0.6);
                transform: scale(1.05);
            }
        }

        .creative-timeline {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-left: 3px solid #667eea;
        }

        .memory-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            transform-origin: center;
        }

        .memory-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 50;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .inspiration-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s ease;
        }

        .inspiration-card:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            transform: translateY(-2px);
            border-color: rgba(102, 126, 234, 0.4);
        }

        .coach-mark {
            animation: bounce-gentle 2s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        @keyframes bounce-gentle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .welcome-animation {
            animation: slide-in-up 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slide-in-up {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0px) scale(1);
            }
        }

        .chat-bubble {
            max-width: 80%;
            word-wrap: break-word;
            animation: pop-in 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes pop-in {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(20px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .hero-section {
            background: radial-gradient(circle at center, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
            min-height: 400px;
        }

        .onboarding-overlay {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .step-indicator {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
        }

        .contextual-hint {
            position: absolute;
            z-index: 40;
            animation: fade-in-bounce 0.6s ease-out;
        }

        @keyframes fade-in-bounce {
            0% {
                opacity: 0;
                transform: translateY(-10px) scale(0.9);
            }
            60% {
                transform: translateY(5px) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .suggestion-pill {
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border: 1px solid rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .suggestion-pill:hover {
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.4), rgba(118, 75, 162, 0.4));
            transform: translateY(-1px);
        }
    </style>
</head>
<body x-data="javStudio()" x-init="init()" class="min-h-screen text-white">
    
    <!-- Onboarding Overlay -->
    <div x-show="showOnboarding" 
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         class="fixed inset-0 onboarding-overlay z-50 flex items-center justify-center">
        
        <div class="glass-panel rounded-2xl p-8 max-w-lg mx-4 welcome-animation">
            <div class="text-center">
                <div class="jav-avatar mx-auto mb-6" @click="javSpeaks()">
                    J
                </div>
                
                <div x-show="onboardingStep === 1">
                    <h2 class="text-2xl font-bold mb-4">Hey there! üëã I'm Jav!</h2>
                    <p class="text-gray-300 mb-6">I'm your creative AI partner. Together, we'll turn ideas into reality through memory-driven collaboration!</p>
                    <button @click="nextOnboardingStep()" 
                            class="magic-gradient px-6 py-3 rounded-lg text-white font-medium">
                        Ready to build together! ‚ú®
                    </button>
                </div>

                <div x-show="onboardingStep === 2">
                    <h3 class="text-xl font-bold mb-4">Our Creative Loop üîÑ</h3>
                    <div class="space-y-3 text-left mb-6">
                        <div class="flex items-center">
                            <div class="step-indicator">1</div>
                            <span>üí≠ Share ideas & brainstorm together</span>
                        </div>
                        <div class="flex items-center">
                            <div class="step-indicator">2</div>
                            <span>üß† I remember everything we create</span>
                        </div>
                        <div class="flex items-center">
                            <div class="step-indicator">3</div>
                            <span>‚ö° Turn conversations into code</span>
                        </div>
                        <div class="flex items-center">
                            <div class="step-indicator">4</div>
                            <span>üöÄ Build & iterate seamlessly</span>
                        </div>
                    </div>
                    <button @click="nextOnboardingStep()" 
                            class="magic-gradient px-6 py-3 rounded-lg text-white font-medium">
                        Show me how! üéØ
                    </button>
                </div>

                <div x-show="onboardingStep === 3">
                    <h3 class="text-xl font-bold mb-4">Let's Create Your First Memory! üåü</h3>
                    <p class="text-gray-300 mb-6">Try typing an idea in the chat below. I'll help you brainstorm and turn it into something amazing!</p>
                    <div class="space-y-3">
                        <button @click="startFirstMission('web app')" 
                                class="w-full suggestion-pill px-4 py-2 rounded-lg text-left">
                            üí° "Help me build a web app"
                        </button>
                        <button @click="startFirstMission('analyze code')" 
                                class="w-full suggestion-pill px-4 py-2 rounded-lg text-left">
                            üîç "Review my code and suggest improvements"
                        </button>
                        <button @click="startFirstMission('creative project')" 
                                class="w-full suggestion-pill px-4 py-2 rounded-lg text-left">
                            üé® "I have a creative project idea"
                        </button>
                    </div>
                    <button @click="completeOnboarding()" 
                            class="mt-4 text-gray-400 hover:text-white text-sm">
                        Skip for now ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header with Jav Avatar -->
    <header class="glass-panel border-b border-white/20 p-4 relative">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="jav-avatar" 
                     @click="javSpeaks()" 
                     :class="{ 'animate-bounce': javIsThinking }">
                    J
                </div>
                <div>
                    <h1 class="text-2xl font-bold">Jav Studio</h1>
                    <p class="text-sm text-gray-300" x-text="javMood"></p>
                </div>
            </div>

            <div class="flex items-center space-x-4">
                <!-- System Status -->
                <div class="flex items-center space-x-2 text-sm">
                    <div class="w-2 h-2 rounded-full" 
                         :class="{ 'bg-red-500': hasErrors, 'bg-yellow-500': hasWarnings, 'bg-green-500': !hasErrors && !hasWarnings }">
                    </div>
                    <span x-text="systemHealth"></span>
                </div>

                <!-- Memory Count -->
                <div class="glass-panel px-3 py-1 rounded-full text-sm">
                    <span x-text="'üß† ' + totalMemories + ' memories'"></span>
                </div>

                <!-- Inspiration Button -->
                <button @click="showInspiration = !showInspiration" 
                        class="glass-panel px-3 py-1 rounded-full text-sm hover:bg-white/10 transition-all">
                    ‚ú® Inspire Me
                </button>
            </div>
        </div>

        <!-- Contextual Jav Speech Bubble -->
        <div x-show="javSpeechBubble" 
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             class="absolute top-full left-20 mt-2 contextual-hint">
            <div class="glass-panel rounded-lg p-3 max-w-xs chat-bubble">
                <p x-text="javCurrentMessage" class="text-sm"></p>
            </div>
        </div>
    </header>

    <div class="flex h-screen">
        <!-- Enhanced Sidebar with Creative Timeline -->
        <aside class="w-80 glass-panel border-r border-white/20 flex flex-col">
            <div class="p-4 border-b border-white/20">
                <h2 class="font-bold text-lg mb-2">üß† Creative Timeline</h2>
                <p class="text-sm text-gray-300" x-text="studioStatus"></p>
            </div>

            <!-- Memory Timeline -->
            <div class="flex-1 overflow-y-auto p-4 space-y-3 creative-timeline">
                <template x-for="item in studioItems" :key="item.id">
                    <div class="memory-card glass-panel rounded-lg p-3"
                         @click="focusMemory(item)">
                        <div class="flex items-start space-x-3">
                            <div class="text-xl" x-text="item.icon"></div>
                            <div class="flex-1 min-w-0">
                                <div class="font-medium text-sm" x-text="item.title"></div>
                                <div class="text-xs text-gray-400 truncate" x-text="item.preview"></div>
                                <div class="text-xs text-blue-400 mt-1" x-text="item.timeAgo"></div>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- Empty State with Inspiration -->
                <div x-show="studioItems.length === 0" class="text-center py-8">
                    <div class="text-4xl mb-4">üå±</div>
                    <p class="text-gray-400 text-sm mb-4">Your creative journey starts here!</p>
                    <button @click="startCreativeSession()" 
                            class="suggestion-pill px-4 py-2 rounded-lg text-sm">
                        Plant your first idea üí°
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Creative Workspace -->
        <main class="flex-1 flex flex-col">
            <!-- Hero Section / Conversation Canvas -->
            <div class="flex-1 hero-section relative overflow-hidden">
                <!-- Inspiration Panel -->
                <div x-show="showInspiration" 
                     x-transition:enter="transition ease-out duration-300"
                     x-transition:enter-start="opacity-0 translate-x-full"
                     x-transition:enter-end="opacity-100 translate-x-0"
                     class="absolute top-0 right-0 w-80 h-full glass-panel border-l border-white/20 p-6 z-30">
                    
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-lg">‚ú® Creative Inspiration</h3>
                        <button @click="showInspiration = false" class="text-gray-400 hover:text-white">‚úï</button>
                    </div>

                    <div class="space-y-4">
                        <div class="inspiration-card rounded-lg p-4 cursor-pointer" 
                             @click="tryExample('build-flask-app')">
                            <div class="flex items-center space-x-3 mb-2">
                                <span class="text-2xl">üåê</span>
                                <span class="font-medium">Build a Flask App</span>
                            </div>
                            <p class="text-xs text-gray-400">Create a web application with database integration</p>
                        </div>

                        <div class="inspiration-card rounded-lg p-4 cursor-pointer" 
                             @click="tryExample('ai-code-review')">
                            <div class="flex items-center space-x-3 mb-2">
                                <span class="text-2xl">üîç</span>
                                <span class="font-medium">AI Code Review</span>
                            </div>
                            <p class="text-xs text-gray-400">Get intelligent feedback on your code quality</p>
                        </div>

                        <div class="inspiration-card rounded-lg p-4 cursor-pointer" 
                             @click="tryExample('data-analysis')">
                            <div class="flex items-center space-x-3 mb-2">
                                <span class="text-2xl">üìä</span>
                                <span class="font-medium">Data Analysis</span>
                            </div>
                            <p class="text-xs text-gray-400">Analyze datasets and create visualizations</p>
                        </div>

                        <div class="inspiration-card rounded-lg p-4 cursor-pointer" 
                             @click="tryExample('api-design')">
                            <div class="flex items-center space-x-3 mb-2">
                                <span class="text-2xl">‚ö°</span>
                                <span class="font-medium">API Design</span>
                            </div>
                            <p class="text-xs text-gray-400">Design and implement RESTful APIs</p>
                        </div>
                    </div>

                    <div class="mt-8 p-4 glass-panel rounded-lg">
                        <h4 class="font-medium mb-2">üí° Pro Tip</h4>
                        <p class="text-xs text-gray-400">The more you interact with me, the better I understand your style and preferences!</p>
                    </div>
                </div>

                <!-- Main Conversation Area -->
                <div class="p-6 overflow-y-auto flex-1" x-ref="conversationContainer" 
                     :class="{ 'mr-80': showInspiration }">
                    
                    <!-- Welcome State -->
                    <div x-show="conversationHistory.length === 0" class="text-center py-20">
                        <div class="welcome-animation">
                            <div class="jav-avatar mx-auto mb-8" style="width: 120px; height: 120px; font-size: 48px;">
                                J
                            </div>
                            <h2 class="text-4xl font-bold mb-4">Ready to Create Together?</h2>
                            <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
                                I'm your memory-driven AI partner. Every conversation becomes part of our shared creative journey.
                            </p>
                            <div class="flex justify-center space-x-4 mb-8">
                                <button @click="startCreativeSession()" 
                                        class="magic-gradient px-8 py-4 rounded-xl text-white font-bold text-lg shadow-2xl transform hover:scale-105 transition-all">
                                    üöÄ Begin Building
                                </button>
                                <button @click="showInspiration = true" 
                                        class="glass-panel px-6 py-4 rounded-xl hover:bg-white/10 transition-all">
                                    ‚ú® Get Inspired
                                </button>
                            </div>
                            
                            <!-- Contextual Suggestions -->
                            <div class="flex justify-center space-x-3 flex-wrap max-w-4xl mx-auto">
                                <button @click="quickStart('project idea')" 
                                        class="suggestion-pill px-4 py-2 rounded-lg text-sm mb-2">
                                    üí° I have a project idea
                                </button>
                                <button @click="quickStart('review code')" 
                                        class="suggestion-pill px-4 py-2 rounded-lg text-sm mb-2">
                                    üîç Review my code
                                </button>
                                <button @click="quickStart('learn something')" 
                                        class="suggestion-pill px-4 py-2 rounded-lg text-sm mb-2">
                                    üìö I want to learn something
                                </button>
                                <button @click="quickStart('debug issue')" 
                                        class="suggestion-pill px-4 py-2 rounded-lg text-sm mb-2">
                                    üêõ Help debug an issue
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Conversation History -->
                    <div x-show="conversationHistory.length > 0" class="space-y-4">
                        <template x-for="message in conversationHistory" :key="message.id">
                            <div class="bg-gray-50 rounded-lg p-4 border-l-4 border-blue-400 chat-bubble">
                                <div class="flex justify-between items-start mb-2">
                                    <span class="text-sm font-medium text-gray-600">
                                        <span x-text="message.role === 'user' ? 'üë§ You' : 'ü§ñ Jav'"></span>
                                    </span>
                                    <span class="text-xs text-gray-500" x-text="message.timestamp"></span>
                                </div>
                                <div class="text-gray-800" x-html="message.content"></div>

                                <!-- Implementation Cards -->
                                <template x-for="impl in message.implementations" :key="impl.id">
                                    <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <h4 class="font-medium text-blue-800 mb-2" x-text="impl.title"></h4>
                                        <p class="text-sm text-blue-700 mb-3" x-text="impl.description"></p>
                                        <div class="flex space-x-2">
                                            <button @click="implementCode(impl)" 
                                                    class="px-3 py-1 bg-blue-200 text-blue-800 rounded text-sm hover:bg-blue-300">
                                                Implement Now
                                            </button>
                                            <button @click="previewCode(impl)" 
                                                    class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-sm hover:bg-gray-300">
                                                Preview
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>
                    </div>

                    <!-- Jav Thinking Indicator -->
                    <div x-show="javTyping" class="flex justify-start mb-6">
                        <div class="glass-panel rounded-2xl p-4 chat-bubble">
                            <div class="flex items-center space-x-3">
                                <div class="jav-avatar" style="width: 30px; height: 30px; font-size: 14px;">J</div>
                                <div class="flex space-x-1">
                                    <div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce"></div>
                                    <div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                    <div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                                </div>
                                <span class="text-gray-300 text-sm">Jav is thinking...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Input Zone -->
            <div class="border-t border-white/20 p-6 glass-panel">
                <!-- Active Implementation Panel -->
                <div x-show="activeImplementation" 
                     x-transition:enter="transition ease-out duration-300"
                     x-transition:enter-start="opacity-0 translate-y-4"
                     x-transition:enter-end="opacity-100 translate-y-0"
                     class="mb-4 glass-panel rounded-lg p-4 border border-blue-400">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium">üöÄ Ready to Implement</h3>
                        <button @click="activeImplementation = null" class="text-gray-400 hover:text-white">‚úï</button>
                    </div>
                    <div class="text-sm text-gray-300 mb-3" x-text="activeImplementation?.description"></div>
                    <div class="flex space-x-2">
                        <button @click="applyImplementation()" 
                                class="px-4 py-2 magic-gradient rounded text-sm font-medium">
                            Apply Changes ‚ú®
                        </button>
                        <button @click="previewImplementation()" 
                                class="px-4 py-2 glass-panel hover:bg-white/10 rounded text-sm">
                            Preview Diff
                        </button>
                        <button @click="editImplementation()" 
                                class="px-4 py-2 glass-panel hover:bg-white/10 rounded text-sm">
                            Edit First
                        </button>
                    </div>
                </div>

                <!-- Contextual Suggestions Row -->
                <div x-show="contextualSuggestions.length > 0" class="mb-4">
                    <div class="flex space-x-2 overflow-x-auto pb-2">
                        <template x-for="suggestion in contextualSuggestions" :key="suggestion.id">
                            <button @click="applySuggestion(suggestion)" 
                                    class="suggestion-pill px-3 py-1 rounded-full text-xs whitespace-nowrap">
                                <span x-text="suggestion.icon"></span>
                                <span x-text="suggestion.text"></span>
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Main Chat Input -->
                <div class="flex space-x-3 items-end">
                    <div class="flex-1">
                        <textarea x-model="chatMessage" 
                                  :disabled="javTyping"
                                  @keydown.enter.prevent="handleEnter($event)"
                                  @input="handleInput()"
                                  @focus="onInputFocus()"
                                  placeholder="Share your ideas, ask questions, or describe what you want to build..."
                                  class="w-full p-4 glass-panel rounded-lg resize-none text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all"
                                  rows="3"></textarea>
                    </div>

                    <div class="flex flex-col space-y-2">
                        <button @click="sendMessage()" 
                                :disabled="!chatMessage.trim() || javTyping"
                                class="px-6 py-4 magic-gradient rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105">
                            <span x-show="!javTyping">Send ‚ú®</span>
                            <span x-show="javTyping">...</span>
                        </button>
                    </div>
                </div>

                <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                    <div>Press Ctrl+Enter to send ‚Ä¢ Drag & drop files to analyze</div>
                    <div x-text="chatMessage.length + '/500'"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Floating Action Button -->
    <div class="floating-action" x-show="conversationHistory.length > 0">
        <button @click="scrollToBottom()" 
                class="jav-avatar shadow-2xl">
            ‚Üì
        </button>
    </div>

    <!-- Coach Mark for First-Time Users -->
    <div x-show="showCoachMark" 
         class="fixed bottom-32 right-32 coach-mark glass-panel rounded-lg p-3 z-40">
        <div class="text-sm">
            üí° Try typing your first idea here!
        </div>
        <button @click="showCoachMark = false" class="text-xs text-gray-400 mt-1">Got it</button>
    </div>

    <script>
        function javStudio() {
            return {
                // Core State
                totalMemories: 0,
                systemHealth: 'Checking...',
                hasErrors: false,
                hasWarnings: false,
                studioStatus: "Initializing creative workspace...",
                studioItems: [],

                // Jav Personality
                javMood: "Ready to create something amazing together! ‚ú®",
                javIsThinking: false,
                javSpeechBubble: false,
                javCurrentMessage: "",
                javMessages: [
                    "What shall we build today? üöÄ",
                    "I'm learning your style with every interaction! üß†",
                    "Ready for another creative breakthrough? ‚ú®",
                    "Your ideas + my memory = pure magic! üí´",
                    "Let's turn that spark into something real! üî•"
                ],

                // Onboarding
                showOnboarding: false,
                onboardingStep: 1,
                isFirstVisit: true,

                // UI State
                showInspiration: false,
                showCoachMark: false,
                contextualSuggestions: [],

                // Conversation
                conversationHistory: [],
                chatMessage: '',
                javTyping: false,

                // Implementation
                activeImplementation: null,
                implementationHistory: [],

                async init() {
                    console.log('üöÄ Initializing Jav Studio...');

                    // Check if user is new
                    this.isFirstVisit = !localStorage.getItem('jav-studio-visited');
                    
                    if (this.isFirstVisit) {
                        setTimeout(() => {
                            this.showOnboarding = true;
                        }, 1000);
                    }

                    // Load initial data
                    await this.loadMemoryBrain();
                    await this.checkSystemHealth();
                    await this.setupContextualSuggestions();

                    // Set up periodic updates
                    this.setupPeriodicUpdates();

                    // Register project
                    try {
                        await this.registerProject();
                    } catch (error) {
                        console.error('Failed to register project:', error);
                    }

                    this.studioStatus = "Creative workspace ready! ‚ú®";
                    
                    // Show welcome message for returning users
                    if (!this.isFirstVisit && this.conversationHistory.length === 0) {
                        setTimeout(() => {
                            this.javSpeaks();
                        }, 2000);
                    }
                },

                // Onboarding Flow
                nextOnboardingStep() {
                    this.onboardingStep++;
                },

                startFirstMission(type) {
                    const missions = {
                        'web app': "I want to build a web application. Can you help me brainstorm the features and get started?",
                        'analyze code': "Can you review my code and suggest improvements? I'd love to learn best practices.",
                        'creative project': "I have a creative project in mind. Let's brainstorm and turn it into reality!"
                    };
                    
                    this.chatMessage = missions[type];
                    this.completeOnboarding();
                    setTimeout(() => {
                        this.sendMessage();
                    }, 500);
                },

                completeOnboarding() {
                    this.showOnboarding = false;
                    localStorage.setItem('jav-studio-visited', 'true');
                    this.isFirstVisit = false;
                    
                    // Show coach mark for input
                    setTimeout(() => {
                        this.showCoachMark = true;
                        setTimeout(() => {
                            this.showCoachMark = false;
                        }, 5000);
                    }, 1000);
                },

                // Jav Personality Methods
                javSpeaks() {
                    const randomMessage = this.javMessages[Math.floor(Math.random() * this.javMessages.length)];
                    this.javCurrentMessage = randomMessage;
                    this.javSpeechBubble = true;
                    
                    setTimeout(() => {
                        this.javSpeechBubble = false;
                    }, 3000);
                },

                // Quick Start Methods
                quickStart(intent) {
                    const quickStartMessages = {
                        'project idea': "I have a project idea I'd like to explore. Can you help me brainstorm and plan it out?",
                        'review code': "Can you review my current code and suggest improvements or optimizations?",
                        'learn something': "I want to learn something new in programming. What would you recommend?",
                        'debug issue': "I'm running into an issue with my code. Can you help me debug it?"
                    };
                    
                    this.chatMessage = quickStartMessages[intent];
                    setTimeout(() => {
                        this.sendMessage();
                    }, 100);
                },

                startCreativeSession() {
                    this.conversationHistory.push({
                        id: Date.now(),
                        role: 'assistant',
                        content: 'üåü **Welcome to your creative workspace!** I\'m Jav, your memory-driven AI partner.\n\nI remember everything we build together, so we can compound our creativity session after session. Every conversation becomes part of our shared journey!\n\n‚ú® **What would you like to create today?**',
                        timestamp: this.formatTimestamp(new Date().toISOString())
                    });

                    this.scrollToBottom();
                    this.setupContextualSuggestions();
                },

                // Inspiration Examples
                tryExample(type) {
                    const examples = {
                        'build-flask-app': "Help me build a Flask web application with user authentication and a dashboard.",
                        'ai-code-review': "Can you review my Python code and suggest improvements for performance and readability?",
                        'data-analysis': "I have a dataset I'd like to analyze. Can you help me create visualizations and insights?",
                        'api-design': "Help me design a RESTful API for a task management application."
                    };
                    
                    this.chatMessage = examples[type];
                    this.showInspiration = false;
                    setTimeout(() => {
                        this.sendMessage();
                    }, 300);
                },

                // Enhanced Input Handling
                onInputFocus() {
                    this.setupContextualSuggestions();
                },

                setupContextualSuggestions() {
                    // Dynamic suggestions based on context
                    if (this.conversationHistory.length === 0) {
                        this.contextualSuggestions = [
                            { id: 1, icon: "üí°", text: "Brainstorm ideas" },
                            { id: 2, icon: "üîç", text: "Review code" },
                            { id: 3, icon: "üöÄ", text: "Build something" },
                            { id: 4, icon: "üìö", text: "Learn together" }
                        ];
                    } else {
                        this.contextualSuggestions = [
                            { id: 5, icon: "‚ú®", text: "Improve this" },
                            { id: 6, icon: "üîÑ", text: "Try alternative" },
                            { id: 7, icon: "üéØ", text: "Add feature" },
                            { id: 8, icon: "üîß", text: "Debug issue" }
                        ];
                    }
                },

                applySuggestion(suggestion) {
                    const suggestionTexts = {
                        1: "I'd like to brainstorm some project ideas. What's possible?",
                        2: "Can you review my code and suggest improvements?",
                        3: "Help me build something cool! I'm open to ideas.",
                        4: "I want to learn something new. What do you recommend?",
                        5: "How can we improve what we just built?",
                        6: "Is there a different approach we could try?",
                        7: "What new features could we add to this?",
                        8: "I'm running into an issue. Can you help debug it?"
                    };
                    
                    this.chatMessage = suggestionTexts[suggestion.id];
                    setTimeout(() => {
                        this.sendMessage();
                    }, 100);
                },

                // Enhanced Message Sending
                async sendMessage() {
                    if (!this.chatMessage.trim() || this.javTyping) return;

                    const userMessage = this.chatMessage.trim();
                    this.chatMessage = '';

                    // Add user message
                    this.conversationHistory.push({
                        id: Date.now(),
                        role: 'user',
                        content: userMessage,
                        timestamp: this.formatTimestamp(new Date().toISOString())
                    });

                    this.scrollToBottom();
                    this.javTyping = true;
                    this.javIsThinking = true;

                    // Update Jav's mood
                    this.javMood = "Processing your brilliant idea... ü§î";

                    try {
                        const response = await fetch('/jav/chat', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                message: userMessage,
                                context: 'creative_studio'
                            })
                        });

                        const result = await response.json();

                        if (result.status === 'success') {
                            this.conversationHistory.push({
                                id: Date.now() + 1,
                                role: 'assistant',
                                content: result.response?.message || result.message,
                                timestamp: this.formatTimestamp(new Date().toISOString()),
                                implementations: result.response?.implementations || []
                            });

                            // Check for implementations
                            if (result.response?.implementations?.length > 0) {
                                this.activeImplementation = result.response.implementations[0];
                            }

                            // Update Jav's mood
                            this.javMood = "That was fun! What's next? ‚ú®";
                        } else {
                            throw new Error(result.error || 'Unknown error');
                        }
                    } catch (error) {
                        console.error('Chat error:', error);
                        this.conversationHistory.push({
                            id: Date.now() + 1,
                            role: 'assistant',
                            content: `I encountered an issue: ${error.message}. But don't worry - our conversation is being saved to memory for next time! üíæ`,
                            timestamp: this.formatTimestamp(new Date().toISOString())
                        });
                        this.javMood = "Oops! But I'm still here for you! üí™";
                    } finally {
                        this.javTyping = false;
                        this.javIsThinking = false;
                        this.scrollToBottom();
                        await this.loadMemoryBrain();
                        this.setupContextualSuggestions();
                    }
                },

                // Implementation Methods
                implementCode(impl) {
                    this.activeImplementation = impl;
                },

                previewCode(impl) {
                    console.log('Previewing implementation:', impl);
                    // Show code preview modal
                },

                async applyImplementation() {
                    if (!this.activeImplementation) return;

                    console.log('Applying implementation:', this.activeImplementation);

                    this.implementationHistory.unshift({
                        ...this.activeImplementation,
                        appliedAt: new Date().toISOString()
                    });

                    this.activeImplementation = null;

                    this.conversationHistory.push({
                        id: Date.now(),
                        role: 'assistant',
                        content: '‚úÖ **Implementation applied!** The changes have been integrated and saved to memory. Ready for the next iteration! üöÄ',
                        timestamp: this.formatTimestamp(new Date().toISOString())
                    });

                    this.scrollToBottom();
                },

                // System Methods
                async loadMemoryBrain() {
                    try {
                        const response = await fetch('/memory?limit=20');
                        const data = await response.json();

                        this.totalMemories = data.memories?.length || 0;

                        this.studioItems = (data.memories || []).map(memory => ({
                            id: memory.timestamp || Date.now(),
                            title: memory.topic || 'Untitled Memory',
                            preview: memory.input?.substring(0, 80) + '...' || 'No preview',
                            icon: this.getMemoryIcon(memory.type),
                            timeAgo: this.getTimeAgo(memory.timestamp),
                            type: memory.type,
                            memory: memory
                        }));

                        this.studioStatus = `Living brain with ${this.totalMemories} memories active ‚ú®`;
                    } catch (error) {
                        console.error('Failed to load memory brain:', error);
                        this.studioStatus = 'Memory brain offline - working in isolation mode';
                    }
                },

                async checkSystemHealth() {
                    try {
                        const response = await fetch('/health');
                        const health = await response.json();

                        this.systemHealth = health.status || 'unknown';
                        this.hasErrors = health.status === 'unhealthy' || health.status === 'error';
                        this.hasWarnings = health.status === 'degraded';
                    } catch (error) {
                        console.error('Health check failed:', error);
                        this.systemHealth = 'offline';
                        this.hasErrors = true;
                    }
                },

                async registerProject() {
                    try {
                        const response = await fetch('/jav/register', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                project_name: 'creative-studio-project',
                                project_type: 'interactive_workspace'
                            })
                        });

                        const result = await response.json();
                        console.log('Project registered:', result);
                    } catch (error) {
                        console.error('Failed to register project:', error);
                    }
                },

                setupPeriodicUpdates() {
                    setInterval(() => {
                        this.checkSystemHealth();
                        this.loadMemoryBrain();
                    }, 30000);
                },

                // Utility Methods
                handleEnter(event) {
                    if (event.ctrlKey || event.metaKey) {
                        this.sendMessage();
                    }
                },

                handleInput() {
                    if (this.chatMessage.length > 500) {
                        this.chatMessage = this.chatMessage.substring(0, 500);
                    }
                },

                focusMemory(item) {
                    this.conversationHistory.push({
                        id: Date.now(),
                        role: 'assistant',
                        content: `üìö **Reviewing memory: "${item.title}"**\n\nOriginal context: ${item.memory.input}\n\nThis memory from ${item.timeAgo} might inform our current work. How does this relate to what we're building now?`,
                        timestamp: this.formatTimestamp(new Date().toISOString())
                    });

                    this.scrollToBottom();
                },

                getMemoryIcon(type) {
                    const icons = {
                        'SystemUpdate': '‚öôÔ∏è',
                        'Feature': '‚ú®',
                        'BugFix': 'üêõ',
                        'Interaction': 'üí¨',
                        'UserInteraction': 'üë§',
                        'user_input': 'üí≠',
                        'ai_response': 'ü§ñ',
                        'conversation': 'üí¨'
                    };
                    return icons[type] || 'üìù';
                },

                getTimeAgo(timestamp) {
                    if (!timestamp) return 'Unknown';
                    const now = new Date();
                    const time = new Date(timestamp);
                    const diff = now - time;
                    const minutes = Math.floor(diff / 60000);
                    const hours = Math.floor(diff / 3600000);
                    const days = Math.floor(diff / 86400000);

                    if (days > 0) return `${days}d ago`;
                    if (hours > 0) return `${hours}h ago`;
                    if (minutes > 0) return `${minutes}m ago`;
                    return 'Just now';
                },

                formatTimestamp(timestamp) {
                    return new Date(timestamp).toLocaleString();
                },

                scrollToBottom() {
                    this.$nextTick(() => {
                        const container = this.$refs.conversationContainer;
                        if (container) {
                            container.scrollTop = container.scrollHeight;
                        }
                    });
                }
            };
        }
    </script>
</body>
</html>
